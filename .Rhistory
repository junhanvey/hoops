summarize(record = wins/(wins + loss)) |>
as.numeric()
}
# tmRec("Southern Utah")
tmRec <- function(team) {
wins, losses <- teamGms(team) |>
tmRec <- function(team) {
c(wins,losses) <- teamGms(team) |>
mutate(
Result = case_when(
(Away == team & Diff > 0) ~ "Win",
(Home == team & Diff < 0) ~ "Win", .default = "Loss")
) |>
summarize(wins = sum(Result == "Win"), loss = sum(Result == "Loss")) |>
summarize(record = wins/(wins + loss)) |>
as.numeric()
}
# tmRec("Southern Utah")
tmRec <- function(team) {
c(wins,losses) <- teamGms(team) |>
mutate(
Result = case_when(
(Away == team & Diff > 0) ~ "Win",
(Home == team & Diff < 0) ~ "Win", .default = "Loss")
) |>
summarize(wins = sum(Result == "Win"), loss = sum(Result == "Loss"))
# summarize(record = wins/(wins + loss))
}
tmRec("Southern Utah")
tmRec <- function(team) {
teamGms(team) |>
mutate(
Result = case_when(
(Away == team & Diff > 0) ~ "Win",
(Home == team & Diff < 0) ~ "Win", .default = "Loss")
) |>
summarize(wins = sum(Result == "Win"), loss = sum(Result == "Loss")) |>
summarize(record = wins/(wins + loss)) |>
as.numeric()
}
tmRec("Southern Utah")
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:1
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
recs23 <- for (i in x){
add_row(recs23, Team = Teams$Away[i], Record = tmRec(Teams$Away[i]))
}
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:1
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
recs23 <- for (i in range(x)){
add_row(recs23, Team = Teams$Away[i], Record = tmRec(Teams$Away[i]))
}
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:1
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
recs23 <- for (i in range(x)){
add_row(recs23, Team = Teams$Away[i], Record = tmRec(Teams$Away[i]))
}
print(recs23)
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:1
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
recs23 |>
for (i in range(x)){
add_row(Team = Teams$Away[i], Record = tmRec(Teams$Away[i]))
}
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:1
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
recs23 <- for (i in range(x)){
add_row(recs23, Team = i, Record = i)
}
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:3
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
recs23 <- for (i in range(x)){
add_row(recs23, Team = "Southern Utah", Record = i)
}
print(recs23)
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:720
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
as_tibble(recs23) <- for (i in range(x)){
add_row(recs23, Team = Teams$Away[i], Record = tmRec(Teams$Away[i]))
}
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:720
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
rec23 <- for (i in range(x)){
add_row(recs23, Team = Teams$Away[i], Record = tmRec(Teams$Away[i]))
}
print(recs23)
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:720
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
records = c() <- for (i in range(x)){
records = tmRec(Teams$Away[i]))
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:720
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
records = c()
for (i in range(x)){
records = tmRec(Teams$Away[i])
}
print(recs23)
tmRec("Chaminade")
for(i in 1:3){
print(i*i)
}
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:720
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
recs23 <- for (i in 1:720){
add_row(recs23, Team = Teams$Away[i], Record = tmRec(Teams$Away[i]))
}
print(recs23)
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:720
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
recs23 <- for (i in Teams$Away){
add_row(recs23, Team = i, Record = tmRec(i))
}
print(recs23)
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:720
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
recs23 <- for (i in Teams$Away){
add_row(recs23, Team = i, Record = tmRec([i]))
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:720
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
recs23 <- for (i in Teams$Away){
add_row(recs23, Team = Teams$Away[i], Record = tmRec(Teams$Away[i]))
}
print(recs23)
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:720
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
recs23 <- for (i in Teams$Away){
add_row(recs23, Team = (Teams$Away[i]), Record = tmRec(Teams$Away[i]))
}
print(recs23)
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:720
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
recs23 <- for (i in x){
add_row(recs23, Team = Teams$Away[i], Record = 0)
}
print(recs23)
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:720
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
recs23 <- for(i in Teams$Away){
add_row(recs23, Team = Teams$Away[i], Record = tmRec(Teams$Away[i]))
}
print(recs23)
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:710
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
recs23 <- for(i in 1:710){
add_row(recs23, Team = Teams$Away[i], Record = tmRec(Teams$Away[i]))
}
print(recs23)
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:710
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
for(i in 1:710){
recs23 <-  add_row(recs23, Team = Teams$Away[i], Record = tmRec(Teams$Away[i]))
}
print(recs23)
View(recs23)
View(recs23)
teamGms("UNT Dallas")
teamGms("Fort Valley St.")
View(cbbga24)
View(cbbga24)
View(cbbga23)
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:710
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
for(i in 1:710){
recs23 <-  add_row(recs23, Team = Teams$Away[i], Record = tmRec(Teams$Away[i]))
}
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Record = numeric()
)
x = 1:710
# recs23 <- add_row(recs23, Team = Teams$Away[1], Record = tmRec(Teams$Away[1]))
for(i in 1:710){
recs23 <-  add_row(recs23, Team = Teams$Away[i], Record = tmRec(Teams$Away[i]))
}
print(recs23)
library(tidyverse)
library(dplyr)
library(magrittr)
library(ggplot2)
library(readr)
cbbga24 <- as_tibble(cbbga24)
cbbga24 <- read.fwf("http://kenpom.com/cbbga24.txt", widths = c(11, 23, 3, 23, 4, 5, 15), strip.white = TRUE, header = FALSE)
cbbga24 <- as_tibble(cbbga24)
cbbga24 <- rename(cbbga24, "Date" = "V1", "Away" = "V2", "AwayPts" = "V3", "Home" = "V4", "HomePts" = "V5",
"Neutral?" = "V6", "Site" = "V7"   )
cbbga24 |>
mutate(Diff = AwayPts - HomePts)
cbbga24 |>
arrange(Home)
cbbga24 |>
select(!c("Neutral?", "Site"))
cbbga24 <-
read.fwf("http://kenpom.com/cbbga24.txt", widths = c(11, 23, 3, 23, 4, 5, 15),
strip.white = TRUE, header = FALSE) |> # a
rename("Date" = "V1", "Away" = "V2", "AwayPts" = "V3", "Home" = "V4",
"HomePts" = "V5", "Neutral?" = "V6", "Site" = "V7" ) |> # b
mutate(Diff = AwayPts - HomePts) |> # c
arrange(Home) |> # d
select(!c("Neutral?", "Site"))  # e
cbbga23 <- cbbga24 |>
mutate(Date = mdy(Date)) |>
filter(Date < '2024-01-01')
as_tibble(cbbga23)
teamGms <- function(team) {
cbbga23 |>
filter(Away == team | Home == team)
}
teamGms("Southern Utah")
teamGms("Southern Utah") |>
mutate(
Result = case_when(
(Away == "Southern Utah" & Diff > 0) ~ "Win",
(Home == "Southern Utah" & Diff < 0) ~ "Win", .default = "Loss")
) |>
summarize(wins = sum(Result == "Win"), loss = sum(Result == "Loss")) |>
summarize(record = wins/(wins + loss)) |>
as.numeric()
teamGms("Southern Utah") |>
mutate(
Result = case_when(
(Away == "Southern Utah" & Diff > 0) ~ "Win",
(Home == "Southern Utah" & Diff < 0) ~ "Win", .default = "Loss")
) |>
summarize(wins = sum(Result == "Win"), loss = sum(Result == "Loss")) |>
# summarize(record = wins/(wins + loss)) |>
as.numeric()
tmRec <- function(team) {
teamGms(team) |>
mutate(
Result = case_when(
(Away == team & Diff > 0) ~ "Win",
(Home == team & Diff < 0) ~ "Win", .default = "Loss")
) |>
summarize(wins = sum(Result == "Win"), loss = sum(Result == "Loss")) |>
# summarize(record = wins/(wins + loss)) |>
as.numeric()
}
tmRec("Southern Utah")
tmRec("Southern Utah")[1]
tmRec <- function(team) {
teamGms(team) |>
mutate(
Result = case_when(
(Away == team & Diff > 0) ~ "Win",
(Home == team & Diff < 0) ~ "Win", .default = "Loss")
) |>
summarize(wins = sum(Result == "Win"), loss = sum(Result == "Loss", record = wins/(wins + loss)) |>
# summarize(record = wins/(wins + loss)) |>
as.numeric()
}
tmRec <- function(team){
teamGms(team) |>
mutate(
Result = case_when(
(Away == team & Diff > 0) ~ "Win",
(Home == team & Diff < 0) ~ "Win", .default = "Loss")
) |>
summarize(wins = sum(Result == "Win"), loss = sum(Result == "Loss"), record = wins/(wins + loss)) |>
# summarize(record = wins/(wins + loss)) |>
as.numeric()
}
tmRec("Southern Utah")
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Wins = numeric(),
Losses = numveric(),
Record = numeric()
)
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Wins = numeric(),
Losses = numeric(),
Record = numeric()
)
x = 1:710
for(i in 1:710){
recs23 <-  add_row(recs23, Team = Teams$Away[i], Wins = tmRec(Teams$Away[i][1]), Losses = tmRec(Teams$Away[i][2]),  Record = tmRec(Teams$Away[i][3]))
}
print(recs23)
tmRec("Southern Utah")[1]
tmRec("Southern Utah") [2]
tmRec("Southern Utah")[3]
Teams <- as_tibble(cbbga23)|>
add_column("Team")|>
group_by(Home) |>
group_by(Away) |>
summarise()
recs23 <- tibble(
Team = character(),
Wins = numeric(),
Losses = numeric(),
Record = numeric()
)
x = 1:710
for(i in 1:710){
recs23 <-  add_row(recs23, Team = Teams$Away[i], Wins = tmRec(Teams$Away[i])[1], Losses = tmRec(Teams$Away[i])[2],  Record = tmRec(Teams$Away[i])[3])
}
print(recs23)
library(hoops)
tmHist("Southern Utah")
ptsHist("Southern Utah")
library(hoops)
ptsHist("Southern Utah")
library(hoops)
library(ggplot2)
library(tidyverse)
library(dplyr)
?teamGms
library(hoops)
teamGms("Southern Utah")
install.packages("usethis")
cbbga23 <- read.csv("data-raw/cbbga23.csv")
setwd("C:/Users/Jun/Documents/MATH3190/hoops")
cbbga23 <- read.csv("data-raw/cbbga23.csv")
usethis::use_data(cbbga23, overwrite = TRUE)
devtools::document()
devtools::document()
devtools::document()
library(hoops)
